"use strict";(self["webpackChunkgo_shopping"]=self["webpackChunkgo_shopping"]||[]).push([[67],{7067:function(s,e,t){t.r(e),t.d(e,{default:function(){return g}});var d=function(){var s=this,e=s._self._c;return e("div",{staticClass:"address-list"},[e("van-nav-bar",{attrs:{fixed:"",title:"地址列表","left-arrow":""},on:{"click-left":s.goWhere}}),s.list.length>0?e("div",[s._m(0),e("van-address-list",{attrs:{switchable:!0,list:s.list,"disabled-list":s.disabledList,"disabled-text":s.disabledText,"default-tag-text":"默认"},on:{select:s.onSelect,add:s.onAdd,edit:s.onEdit},model:{value:s.chosenAddressId,callback:function(e){s.chosenAddressId=e},expression:"chosenAddressId"}})],1):e("van-empty",{attrs:{description:"空空如也"}},[e("van-button",{staticClass:"bottom-button",attrs:{round:"",type:"danger"},on:{click:s.onAdd}},[s._v("添加地址")])],1)],1)},i=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"address-list-header"},[e("p",{staticClass:"header-text"},[s._v("请选择或管理收货地址")])])}],a=(t(7345),t(6579)),r=t(3518),o=t(4959),n=t(2776),l=t(4776),c={name:"AddressList",mixins:[o.A,l.A],data(){return{zeroId:0,chosenAddressId:0,list:[],disabledList:[]}},computed:{...(0,r.L8)("Address",["getDefaultAddressId"]),disabledText(){return this.disabledList.length>0?"以下地址超出配送范围":""}},async created(){await this.doLoad()},methods:{...(0,r.i0)("Address",["getAddressList"]),...(0,r.PY)("Address",["SET_ADDRESS_ID","SET_SELECTED_ADDRESS_ID"]),async myAdressList(){const{data:{list:s}}=await(0,n.Re)();return s},formatStructure(s){s.id=s.address_id,s.tel=s.phone,s.address=s.region+" "+s.detail,delete s.address_id,delete s.phone,delete s.region,delete s.detail},async myDefaultAddressId(){const s=await(0,n.nF)();return s},async setDefaultAddress(s){await(0,n.y_)(s)},async myAddressDetail(s){const{data:{detail:e}}=await(0,n.Yx)(s);return e},async onSelect(s){console.log("选中了item：",s),a.A.alert({title:"选择确认",message:"您确定选择这个地址为默认地址吗？\n收货地址为默认地址哦",showCancelButton:!0}).then((()=>{this.SET_SELECTED_ADDRESS_ID(s.id),this.setDefaultAddress(s.id),this.doLoad()})).catch((()=>{this.chosenAddressId=this.zeroId}))},onAdd(){this.$router.replace({name:"AddressE",query:{...this.$route.query}})},onEdit(s){this.SET_ADDRESS_ID(s.id),console.log("跳转到编辑：",s),this.$router.replace({name:"AddressE",query:{...this.$route.query}})},async doLoad(){try{const s=await this.myDefaultAddressId();this.chosenAddressId=s.data.defaultId,this.zeroId=this.chosenAddressId,console.log("拉取默认地址id：",this.chosenAddressId)}catch(s){this.chosenAddressId=this.list[0].id,console.log("获取默认地址id失败：",s)}try{this.list=await this.myAdressList(),this.list.forEach((s=>{s.isDefault=!1})),this.list.forEach((s=>{Number(s.address_id)===Number(this.chosenAddressId)&&(s.isDefault=!0)})),this.list.forEach((s=>{s.region=this.getRegionStrByCode(this.getRegionCode(s.province_id,s.city_id,s.region_id))})),this.list.forEach((s=>{s=this.formatStructure(s)}))}catch(s){this.list=[],console.log("获取地址列表失败：",s)}},goWhere(){this.getFrom?"pay"===this.getFrom?(console.log("跳转到支付页面"),this.$router.replace({name:"Pay",query:{...this.$route.query}})):this.getFrom:this.$router.go(-1)}}},h=c,u=t(1656),A=(0,u.A)(h,d,i,!1,null,"e06a0ea8",null),g=A.exports}}]);
//# sourceMappingURL=67.cfc6ffed.js.map