"use strict";(self["webpackChunkgo_shopping"]=self["webpackChunkgo_shopping"]||[]).push([[27],{8027:function(e,s,d){d.r(s),d.d(s,{default:function(){return I}});var t=function(){var e=this,s=e._self._c;return s("div",{staticClass:"address-list"},[s("van-nav-bar",{attrs:{fixed:"",title:"地址编辑","left-arrow":""},on:{"click-left":e.goAddressM}}),s("div",{staticClass:"address-edit"},[s("van-address-edit",{attrs:{"address-info":e.addressInfo,"area-list":e.areaList,"show-delete":"","show-set-default":!!e.editAddressId,"show-search-result":"","search-result":e.searchResult,"area-columns-placeholder":["请选择","请选择","请选择"],"detail-maxlength":20},on:{save:e.onSave,delete:e.onDelete,"change-default":e.onChangeDefault}})],1)],1)},a=[],o=(d(1860),d(1981)),i=d(3518),r=d(7020),n=d(2776),l=d(4959),c=d(4776),h={name:"AddressEdit",mixins:[l.A,c.A],data(){return{ifDefaultId:0,addressInfo:{},areaList:r.G,searchResult:[],checkDefault:!1}},computed:{editAddressId(){return this.getAddressId()}},async created(){if(0!==this.editAddressId){console.log("this.editAddressId:",this.editAddressId);try{const{data:{detail:e}}=await(0,n.Yx)(this.editAddressId);this.addressInfo=e}catch(e){console.log(e)}try{this.ifDefaultId=await(0,n.nF)()}catch(e){this.addressInfo.isDefault=!1,console.log("用户默认地址为空")}this.addressInfo.address_id===this.ifDefaultId?this.addressInfo.isDefault=!0:this.addressInfo.isDefault=!1,console.log("setDefaultAft:this.addressInfo",this.addressInfo);const s=this.getRegionCode(this.addressInfo.province_id,this.addressInfo.city_id,this.addressInfo.region_id);console.log("resCode:",s),this.addressInfo.region_id=String(s),this.addressInfo.region=this.getRegionStrByCode(this.addressInfo.region_id),this.formatStructure(this.addressInfo),console.log("格式化后的this.addressInfo:",this.addressInfo)}},methods:{...(0,i.i0)("Address",["getAddressDetail","addAddress","updateAddress"]),...(0,i.PY)("Address",["CLEAR_ADDRESS_ID"]),...(0,i.L8)("Address",["getAddressId"]),async addOneTrue(e){const s={form:{name:e.name,phone:"13233324567",region:[{value:1,label:"北京"},{value:2,label:"北京市"},{value:3,label:"东城区"}],detail:"这是一个有效的测试地址"}};try{await(0,n.E1)(s),(0,o.A)("保存成功")}catch(d){console.log("添加后端有效地址错误：",d)}},async addOneAdress(e){console.log("新增地址:",e);const{provinceId:s,cityId:d,countyId:t}=this.getIdsFromRegionCode(e.areaCode),a={form:{name:e.name,phone:e.tel,region:[{value:Number(s),label:e.province},{value:Number(d),label:e.city},{value:Number(t),label:e.county}],detail:e.addressDetail}};console.log("dataObj:",a);try{await(0,n.E1)(a),(0,o.A)("保存成功"),console.log("新增地址成功")}catch(i){console.log(i)}},async updateOneAdress(e){console.log("更新地址:",e);const s=this.getIdsFromRegionCode(String(e.areaCode));console.log("res:",s);const d={addressId:String(e.id),form:{name:e.name,phone:e.tel,region:[{value:s.provinceId,label:e.province},{value:s.cityId,label:e.city},{value:s.countyId,label:e.county}],detail:e.addressDetail}};if(e.isDefault)try{await(0,n.y_)(e.id),console.log("设置默认地址成功：",e.id)}catch(t){console.log(t)}try{await(0,n.yU)(d),(0,o.A)("修改成功"),console.log("更新地址成功")}catch(t){console.log(t)}},async onSave(e){0===this.editAddressId?this.addOneAdress(e):this.updateOneAdress(e)},async onDelete(e){console.log("删除地址:",e),await(0,n.ab)(e.address_id),(0,o.A)("删除成功"),this.$router.replace({name:"AddressM",query:{...this.$route.query}})},formatStructure(e){e.id=e.address_id,e.tel=e.phone,e.province=e.province_id,e.city=e.city_id,e.county=e.region_id,e.addressDetail=e.detail,e.areaCode=e.region_id,delete e.address_id,delete e.phone,delete e.province_id,delete e.city_id,delete e.region_id,delete e.detail},goAddressM(){this.$router.replace({name:"AddressM",query:{adsid:this.adsId,...this.$route.query}})},onChangeDefault(e){this.addressInfo.isDefault=e,console.log("设置默认地址的按钮被触发, this.addressInfo.isDefault:",this.addressInfo.isDefault)}},destroyed(){this.CLEAR_ADDRESS_ID()}},u=h,f=d(1656),g=(0,f.A)(u,t,a,!1,null,"90aecf6a",null),I=g.exports}}]);
//# sourceMappingURL=27.9b6b4d43.js.map